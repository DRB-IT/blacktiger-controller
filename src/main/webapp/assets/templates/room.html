<div ng-show="false" id="error-dialog" class="alert alert-danger"></div>
<!--bt-participants></bt-participants-->

<div ng-if="currentRoom === null" class="alert alert-info">
    No room displayable for current user.
</div>

<div ng-if="currentRoom !== null">

    <div class="alert alert-info" ng-show="participants.length==0">{{'PARTICIPANTS.WARNINGS.NO_PARTICIPANTS_AND_TRANSMITTERS' | translate}}</div>
    
    <div class="alert alert-danger" ng-show="(participants|filter:{host:true}).length==0 && (participants|filter:{host:false}).length>0">
        <b>{{'PARTICIPANTS.WARNINGS.PARTICIPANTS_BUT_NO_TRANSMITTER_TITLE' | translate}}</b>
        <ol>
            <li ng-bind-html-unsafe="'PARTICIPANTS.WARNINGS.PARTICIPANTS_BUT_NO_TRANSMITTER_TEXT1' | translate:translationData "></li>
            <li ng-bind-html-unsafe="'PARTICIPANTS.WARNINGS.PARTICIPANTS_BUT_NO_TRANSMITTER_TEXT2' | translate"></li>
            <li ng-bind-html-unsafe="'PARTICIPANTS.WARNINGS.PARTICIPANTS_BUT_NO_TRANSMITTER_TEXT3' | translate"></li>
        </ol>
    </div>
    
    <h3>{{'PARTICIPANTS.PARTICIPANTS' | translate}}
        <small class="pull-right" ng-show="(participants|filter:{host:true}).length==0">{{'PARTICIPANTS.INFO.NO_HOST' | translate}}</small>
        <small class="pull-right" ng-repeat="participant in participants | filter:{host:true}" ng-animate=" 'animate' ">{{participant.name}} &bull; <a href="#" class="text-danger" ng-click="kickParticipant(participant.userId)" title="{{'PARTICIPANTS.ABORT_TRANSMISSION' | translate}}">{{'PARTICIPANTS.ABORT_TRANSMISSION' | translate}} <span class="glyphicon glyphicon-off"></span></a></small>
    </h3>
    <table class="table table-striped table-hover table-condensed participantsTable">
        <tbody>
        <tr ng-show="(participants|filter:{host:false}).length==0">
            <td>{{'PARTICIPANTS.INFO.NO_PARTICIPANTS' | translate}}</td>
        </tr>
        <tr ng-repeat="participant in participants | filter:{host:false}">
            <td class="participantNumber" data-type="participant-number" data-id="{{participant.userId}}" data-number="{{participant.phoneNumber}}">
                <bt-iconifiednumber number="{{participant.phoneNumber}}"></bt-iconifiednumber>
            </td>
            <td class="participantName">
                {{participant.name}}
                <span ng-hide="participant.muted" class="label label-warning">{{'PARTICIPANTS.INFO.UNMUTED' | translate}}</span>
                <span ng-show="participant.commentRequested" class="label label-primary shake">Ønsker at svare</span>
            </td>
            <td class="participantOptions">
                <button ng-click="changeName(participant.phoneNumber, participant.name)" title="{{'PARTICIPANTS.EDIT' | translate}}"><span class="glyphicon glyphicon-pencil"></span></button>
                <button ng-click="muteParticipant(participant.userId, false)" ng-show="participant.muted" title="{{'PARTICIPANTS.UNMUTE' | translate}}"><span class="glyphicon glyphicon-comment"></span></button>
                <button ng-click="muteParticipant(participant.userId, true)" ng-hide="participant.muted" class="active" title="{{'PARTICIPANTS.MUTE' | translate}}"><span class="glyphicon glyphicon-comment"></span></button>
                <button ng-click="kickParticipant(participant.userId)" title="{{'PARTICIPANTS.KICK' | translate}}"><span class="glyphicon glyphicon-remove"></span></button>
            </td>
        </tr>
        </tbody>
    </table>
    
    <!--bt-history></bt-history-->
    <h3>{{'PARTICIPANTS.COMPLETED_CALLS' | translate}}
        <a href="/status-no-history.html" onclick="window.confirm('Er du sikker på at du vil slette historiken?')" class="btn btn-link btn-sm pull-right">Slet historik <span class="glyphicon glyphicon-trash"></span></a>
    </h3>
    <table class="table table-striped table-hover table-condensed participantsTable">
        <thead>
            <tr>
                <th>Nummer</th>
                <th>Navn</th>
                <th>Start <small class="glyphicon glyphicon-chevron-up"></small></th>
                <th>Antal</th>
                <th>Varighed</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        <tr ng-show="history.length==0">
            <td colspan="6">Der er ingen historik gemt for i dag.</td>
        </tr>
        <tr ng-repeat="entry in history">
            <td class="participantNumber"><bt-iconifiednumber number="{{entry.phoneNumber}}"></bt-iconifiednumber></td>
            <td class="participantName">{{entry.name}}</td>
            <td class="participantHistory">{{entry.firstCallTimestamp | date:'HH:mm'}}</td>
            <td class="participantHistory">{{entry.numberOfCalls}}</td>
            <td class="participantHistory">{{entry.totalDuration*1000 | timespan}}</td>
            <td class="participantOptions">
                <button ng-click="changeName(entry.phoneNumber, entry.name)" title="{{'PARTICIPANTS.EDIT' | translate}}"><span class="glyphicon glyphicon-pencil"></span></button>
            </td>
        </tr>
        </tbody>
    </table>

</div>
